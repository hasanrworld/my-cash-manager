<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MY CASH - Personal Expense Manager</title>
<style>
:root{
  --bg:#f4f7fb; --card:#ffffff; --text:#0f1724; --muted:#6b7280; --primary:#2563eb; --accent:#10b981; --danger:#ef4444; --radius:14px; --shadow:0 10px 30px rgba(2,6,23,0.08);
}
:root[data-theme='dark']{ --bg:#071126; --card:#0b1221; --text:#e6eef8; --muted:#9aa6bf; --primary:#60a5fa; --accent:#34d399; --danger:#f87171; --shadow:0 10px 30px rgba(0,0,0,0.6); }
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;background:var(--bg);color:var(--text)}
/* header */
.app-header{position:sticky;top:0;background:var(--card);box-shadow:var(--shadow);padding:12px 16px;display:flex;flex-direction:column;gap:8px;z-index:100}
.brand{display:flex;align-items:center;gap:12px}
.logo{width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,var(--primary),#7c3aed);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
.title-wrap h1{margin:0;font-size:1.1rem}
.title-wrap p{margin:0;color:var(--muted);font-size:0.85rem}
.controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
.date-input,.search-input{flex:1;min-width:140px}
.search-input{min-width:160px}
.burger, .theme-toggle{background:none;border:0;font-size:20px;cursor:pointer}
/* page cards */
.container { width: 100%; max-width: 100%; margin: 12px auto; padding: 0 4vw 20vh; }
.card{background:var(--card);border-radius:12px;padding:14px;box-shadow:var(--shadow);}
.balance{display:flex;justify-content:space-between;align-items:center;gap:12px}
.balance h2{margin:0}
.balance .amount{font-size:1.5rem;font-weight:800;color:var(--primary)}
.transactions{margin-top:14px}
.tx{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent),var(--card);box-shadow:0 6px 18px rgba(2,6,23,0.03);margin-bottom:10px}
.tx .left{display:flex;flex-direction:column}
.tx .meta{color:var(--muted);font-size:0.9rem}
.tx .amt{font-weight:800;min-width:100px;text-align:right}
.amt.in{color:var(--accent)}
.amt.out{color:var(--danger)}
.tx .actions button{margin-left:8px;padding:6px 8px;border-radius:8px;border:0;cursor:pointer}
/* side menu */
.side-menu{position:fixed;top:0;right:-320px;width:320px;height:100%;background:var(--card);box-shadow:var(--shadow);transition:right 0.28s ease;padding:16px;z-index:80}
.side-menu.open{right:0}
.side-menu h3{margin-top:0}
.side-menu label{display:block;margin-top:8px;color:var(--muted)}
.side-menu select,input,button{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);margin-top:8px}
.side-menu .small-rows{display:flex;gap:8px}
.side-menu .small-rows button{flex:1}
/* bottom action bar */
.action-bar{position:fixed;left:12px;right:12px;bottom:12px;display:flex;gap:12px;z-index:90}
.action-bar .big-btn{flex:1;padding:3vw 0;border-radius:14px;border:0;font-weight:800;font-size:clamp(0.9rem, 2.5vw, 1.2rem);cursor:pointer;color:white}
.big-income{background:linear-gradient(90deg,var(--accent),#06b6a4)}
.big-expense{background:linear-gradient(90deg,var(--danger),#ef4444)}
/* modal */
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,0.45);z-index:120}
.modal .panel{width:100%;max-width:520px;padding:16px;border-radius:12px;background:var(--card)}
.modal .panel label{display:block;margin-top:8px;color:var(--muted)}
.modal .panel input{width:100%;padding:8px;margin-top:6px;border-radius:8px;border:1px solid rgba(0,0,0,0.06)}
/* responsive */
@media(max-width:640px){
  .controls .search-input{min-width:90px}
  .side-menu{width:100%;right:-100%}
  .side-menu.open{right:0}
}

@media (max-width: 1024px) {
  .balance .amount {
    font-size: 1.2rem;
  }
  .controls {
    flex-wrap: wrap;
  }
}


@media (min-width: 768px) {
  .app-header {
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }
  .controls {
    flex-wrap: nowrap;
  }
}

</style>
</head>
<body>
<header class="app-header">
  <div class="brand">
    <div class="logo">MC</div>
    <div class="title-wrap"><h1>MY CASH</h1><p>Personal Expense Manager</p></div>
  </div>
  <div class="controls">
    <input id="dateFilter" class="date-input" type="date" aria-label="Select date">
    <input id="searchInput" class="search-input" placeholder="Search description or amount" aria-label="Search transactions">
    <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark/light">🌓</button>
    <button id="burgerBtn" class="burger" aria-label="Open menu">☰</button>
  </div>
</header>
<main class="container">
  <section class="card balance">
    <div>
      <h2>Net Balance</h2>
      <div class="meta muted">Overall wallet balance</div>
    </div>
    <div>
      <div class="amount" id="netBalance">0</div>
      <div class="meta muted" id="totals">In: 0 • Out: 0</div>
    </div>
  </section>

  <section class="transactions">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <h3 style="margin:0">Transactions</h3>
      <div class="meta muted" id="entriesCount">0 entries</div>
    </div>
    <div id="transactionList" style="margin-top:12px"></div>
  </section>
</main>

<!-- Bottom action bar -->
<div class="action-bar">
  <button id="addIncome" class="big-btn big-income">+ Income</button>
  <button id="addExpense" class="big-btn big-expense">- Expense</button>
</div>

<!-- Side menu -->
<aside id="sideMenu" class="side-menu" aria-hidden="true">
  <h3>Menu</h3>
  <label for="walletSelect">Wallet</label>
  <select id="walletSelect"></select>
  <div class="small-rows">
    <button id="addWalletBtn">New Wallet</button>
    <button id="deleteWalletBtn">Delete Wallet</button>
  </div>
  <hr style="margin-top:12px">
  <strong>Backup & Restore</strong>
  <button id="backupToFileBtn">Backup to File</button>
  <button id="restoreFromFileBtn">Restore from File</button>
  <input id="fileInput" type="file" accept=".json" style="display:none">
  <hr style="margin-top:12px">
  <button id="closeMenuBtn">Close</button>
</aside>

<!-- Modal: Add/Edit transaction -->
<div id="transactionModal" class="modal" aria-hidden="true">
  <div class="panel">
    <h3 id="modalTitle">Add transaction</h3>
    <label>Type</label>
    <select id="modalType"><option value="in">Income</option><option value="out">Expense</option></select>
    <label>Amount</label>
    <input id="modalAmount" type="number" step="0.01" />
    <label>Description</label>
    <input id="modalDescription" type="text" maxlength="100" />
    <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:12px">
      <button id="cancelModal" style="padding:8px 12px;border-radius:8px;border:1px solid #ddd;background:transparent;">Cancel</button>
      <button id="saveModal" style="padding:8px 12px;border-radius:8px;border:0;background:var(--primary);color:white">Save</button>
    </div>
  </div>
</div>

<script>
/* Fully functional app: wallets, transactions, date filter (default today), add/edit/delete, backup/restore, burger menu, theme */

(function(){
  // state
  let wallets = {};
  let currentWalletId = 'main';
  let editingTransactionId = null;

  // dom refs
  const $ = sel => document.querySelector(sel);
  const elements = {
    dateFilter: $('#dateFilter'),
    searchInput: $('#searchInput'),
    transactionList: $('#transactionList'),
    entriesCount: $('#entriesCount'),
    netBalance: $('#netBalance'),
    totals: $('#totals'),
    addIncome: $('#addIncome'),
    addExpense: $('#addExpense'),
    sideMenu: $('#sideMenu'),
    burgerBtn: $('#burgerBtn'),
    walletSelect: $('#walletSelect'),
    addWalletBtn: $('#addWalletBtn'),
    deleteWalletBtn: $('#deleteWalletBtn'),
    backupToFileBtn: $('#backupToFileBtn'),
    restoreFromFileBtn: $('#restoreFromFileBtn'),
    fileInput: $('#fileInput'),
    closeMenuBtn: $('#closeMenuBtn'),
    transactionModal: $('#transactionModal'),
    modalTitle: $('#modalTitle'),
    modalType: $('#modalType'),
    modalAmount: $('#modalAmount'),
    modalDescription: $('#modalDescription'),
    cancelModal: $('#cancelModal'),
    saveModal: $('#saveModal'),
    themeToggle: $('#themeToggle')
  };

  // storage
  function saveToLocalStorage(){ try{ localStorage.setItem('wallets', JSON.stringify(wallets)); }catch(e){ console.error('save error', e); } }
  function loadFromLocalStorage(){ const raw = localStorage.getItem('wallets'); if(!raw){ wallets = { main: [] }; saveToLocalStorage(); return; } try{ const parsed = JSON.parse(raw); for(const k in parsed) parsed[k] = parsed[k].map(t=> ({ ...t, date: new Date(t.date) })); wallets = parsed; if(!wallets[currentWalletId]) currentWalletId = Object.keys(wallets)[0] || 'main'; }catch(e){ console.error('parse error', e); wallets = { main: [] }; saveToLocalStorage(); } }

  // wallets
  function populateWalletSelector(){ const sel = elements.walletSelect; sel.innerHTML=''; Object.keys(wallets).forEach(k=>{ const o = document.createElement('option'); o.value = k; o.textContent = k.charAt(0).toUpperCase()+k.slice(1); sel.appendChild(o); }); sel.value = currentWalletId; }
  function addWallet(){ const name = prompt('Wallet name:'); if(!name) return; const key = name.trim().toLowerCase(); if(wallets[key]){ alert('Wallet exists'); return; } wallets[key] = []; currentWalletId = key; saveToLocalStorage(); populateWalletSelector(); renderAll(); }
  function deleteWallet(){ const keys = Object.keys(wallets); if(keys.length<=1){ alert('Cannot delete last wallet'); return; } if(!confirm('Delete wallet and all its transactions?')) return; delete wallets[currentWalletId]; currentWalletId = Object.keys(wallets)[0]; saveToLocalStorage(); populateWalletSelector(); renderAll(); }

  // transactions
  function getTransactions(){ if(!wallets[currentWalletId]) wallets[currentWalletId]=[]; return wallets[currentWalletId]; }
  function recalcBalances(){ const arr = getTransactions(); if(arr.length===0) return; const asc = [...arr].sort((a,b)=>a.date - b.date); let running = 0; for(const t of asc){ running += (t.type==='in' ? t.amount : -t.amount); t.balance = running; } arr.sort((a,b)=>b.date - a.date); }
  function ymd(d){ return d.toISOString().split('T')[0]; }
  function formatDate(d){ return d.toLocaleDateString(); }
  function formatTime(d){ return d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}); }

  function getFilteredTransactions(){ const selDate = elements.dateFilter.value; const q = elements.searchInput.value.trim().toLowerCase(); const arr = getTransactions(); return arr.filter(t=>{ if(selDate && ymd(t.date)!==selDate) return false; if(q && !(t.description.toLowerCase().includes(q) || t.amount.toString().includes(q))) return false; return true; }).sort((a,b)=>b.date - a.date); }

  function renderTransactions(){ const list = elements.transactionList; list.innerHTML=''; const txs = getFilteredTransactions(); if(txs.length===0){ const d = document.createElement('div'); d.className='card'; d.textContent = 'No transactions for selected date.'; list.appendChild(d); elements.entriesCount.textContent = '0 entries'; elements.totals.textContent = 'In: 0 • Out: 0'; return; } let totalIn=0, totalOut=0; for(const t of txs){ const elTx = document.createElement('div'); elTx.className='tx'; const left = document.createElement('div'); left.className='left'; const desc = document.createElement('div'); desc.textContent = t.description; desc.style.fontWeight = 700; const meta = document.createElement('div'); meta.className='meta'; meta.textContent = `${formatDate(t.date)} • ${formatTime(t.date)}`; left.appendChild(desc); left.appendChild(meta); const right = document.createElement('div'); right.style.display='flex'; right.style.flexDirection='column'; right.style.alignItems='flex-end'; const amt = document.createElement('div'); amt.className = 'amt ' + (t.type==='in'?'in':'out'); amt.textContent = (t.type==='in'?'+':'-') + t.amount.toLocaleString(); const actions = document.createElement('div'); actions.className='actions'; const editBtn = document.createElement('button'); editBtn.textContent='Edit'; editBtn.addEventListener('click', ()=> openModalForEdit(t.id)); const delBtn = document.createElement('button'); delBtn.textContent='Delete'; delBtn.style.background='#fdecea'; delBtn.addEventListener('click', ()=> { if(confirm('Delete transaction?')) deleteTransaction(t.id); }); actions.appendChild(editBtn); actions.appendChild(delBtn); right.appendChild(amt); right.appendChild(actions); elTx.appendChild(left); elTx.appendChild(right); list.appendChild(elTx); if(t.type==='in') totalIn += t.amount; else totalOut += t.amount; } elements.entriesCount.textContent = `${txs.length} ${txs.length===1?'entry':'entries'}`; elements.totals.textContent = `In: ${totalIn.toLocaleString()} • Out: ${totalOut.toLocaleString()}`; }

  function updateNetBalance(){ const arr = getTransactions(); if(arr.length===0){ elements.netBalance.textContent = '0'; return; } elements.netBalance.textContent = (arr[0]?.balance || 0).toLocaleString(); }

  // modal
  function openModal(type='in'){ editingTransactionId = null; elements.modalTitle.textContent = type==='in' ? 'Add Income' : 'Add Expense'; elements.modalType.value = type; elements.modalAmount.value = ''; elements.modalDescription.value = ''; elements.transactionModal.style.display='flex'; }
  function openModalForEdit(id){ const arr = getTransactions(); const tx = arr.find(x=>x.id===id); if(!tx) return; editingTransactionId = id; elements.modalTitle.textContent = 'Edit Transaction'; elements.modalType.value = tx.type; elements.modalAmount.value = tx.amount; elements.modalDescription.value = tx.description; elements.transactionModal.style.display='flex'; }
  function closeModal(){ elements.transactionModal.style.display='none'; editingTransactionId = null; }

  function saveModal(){ const type = elements.modalType.value; const amount = parseFloat(elements.modalAmount.value); const description = elements.modalDescription.value.trim(); if(isNaN(amount) || amount<=0){ alert('Enter valid amount'); return; } if(!description){ alert('Enter description'); return; } const arr = getTransactions(); if(editingTransactionId){ const idx = arr.findIndex(x=>x.id===editingTransactionId); if(idx!==-1){ arr[idx].type = type; arr[idx].amount = amount; arr[idx].description = description; arr[idx].date = new Date(arr[idx].date); } } else { const id = arr.length ? Math.max(...arr.map(a=>a.id))+1 : 1; arr.unshift({ id, type, amount, description, date: new Date(), balance:0 }); } recalcBalances(); saveToLocalStorage(); renderAll(); closeModal(); }

  function deleteTransaction(id){ const arr = getTransactions(); const idx = arr.findIndex(x=>x.id===id); if(idx!==-1) arr.splice(idx,1); recalcBalances(); saveToLocalStorage(); renderAll(); }

  // backup/restore
  function backupToFile(){ const filename = `my_cash_backup_${new Date().toISOString().slice(0,10)}.json`; const blob = new Blob([JSON.stringify(wallets,null,2)],{type:'application/json'}); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = filename; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url); alert('Backup saved to file'); }
  function handleRestoreFile(file){ const reader = new FileReader(); reader.onload = (e)=>{ try{ const data = JSON.parse(e.target.result); for(const k in data) data[k] = data[k].map(t=>({...t, date: new Date(t.date)})); if(!confirm('Restoring will overwrite your current wallets. Continue?')) return; wallets = data; saveToLocalStorage(); populateWalletSelector(); renderAll(); alert('Restore complete'); }catch(err){ alert('Invalid file'); console.error(err); } }; reader.readAsText(file); }

  // render
  function renderAll(){ recalcBalances(); updateNetBalance(); renderTransactions(); }

  function ensureDefaults(){ if(!wallets || Object.keys(wallets).length===0){ wallets = { main: [ { id:1, type:'out', amount:110, description:'Sadqa', date:new Date('2025-07-15T22:54:00'), balance:0 }, { id:2, type:'out', amount:1490, description:'Bought snacks', date:new Date('2025-07-15T22:53:00'), balance:0 }, { id:3, type:'in', amount:5000, description:'Salary', date:new Date('2025-07-10T09:00:00'), balance:0 } ] }; saveToLocalStorage(); } if(!wallets[currentWalletId]) currentWalletId = Object.keys(wallets)[0]; }

  // theme
  function applySavedTheme(){ if(localStorage.getItem('theme')==='dark'){ document.documentElement.setAttribute('data-theme','dark'); elements.themeToggle.textContent = '☀️'; } else { document.documentElement.removeAttribute('data-theme'); elements.themeToggle.textContent = '🌓'; } }
  elements.themeToggle && elements.themeToggle.addEventListener('click', ()=>{ if(document.documentElement.getAttribute('data-theme')==='dark'){ localStorage.setItem('theme','light'); document.documentElement.removeAttribute('data-theme'); elements.themeToggle.textContent = '🌓'; } else { localStorage.setItem('theme','dark'); document.documentElement.setAttribute('data-theme','dark'); elements.themeToggle.textContent = '☀️'; } });

  // events wiring
  document.addEventListener('DOMContentLoaded', ()=>{
    loadFromLocalStorage(); ensureDefaults(); populateWalletSelector(); recalcBalances(); elements.dateFilter.value = new Date().toISOString().split('T')[0]; applySavedTheme(); renderAll();

    // burger
    elements.burgerBtn.addEventListener('click', ()=>{ elements.sideMenu.classList.toggle('open'); elements.sideMenu.setAttribute('aria-hidden', elements.sideMenu.classList.contains('open') ? 'false' : 'true'); });
    elements.closeMenuBtn.addEventListener('click', ()=>{ elements.sideMenu.classList.remove('open'); elements.sideMenu.setAttribute('aria-hidden','true'); });

    // wallets
    elements.walletSelect.addEventListener('change', (e)=>{ currentWalletId = e.target.value; renderAll(); elements.sideMenu.classList.remove('open'); });
    elements.addWalletBtn.addEventListener('click', addWallet);
    elements.deleteWalletBtn.addEventListener('click', deleteWallet);

    // date & search
    elements.dateFilter.addEventListener('change', renderTransactions);
    elements.searchInput.addEventListener('input', renderTransactions);

    // add/edit
    elements.addIncome.addEventListener('click', ()=> openModal('in'));
    elements.addExpense.addEventListener('click', ()=> openModal('out'));
    elements.cancelModal.addEventListener('click', closeModal);
    elements.saveModal.addEventListener('click', saveModal);

    // backup/restore
    elements.backupToFileBtn.addEventListener('click', backupToFile);
    elements.restoreFromFileBtn.addEventListener('click', ()=> elements.fileInput.click());
    elements.fileInput.addEventListener('change', (e)=>{ const f = e.target.files[0]; if(f) handleRestoreFile(f); elements.fileInput.value = ''; elements.sideMenu.classList.remove('open'); });

    // modal overlay close
    document.querySelectorAll('.modal').forEach(m=> m.addEventListener('click', (ev)=>{ if(ev.target===m) m.style.display='none'; }));
  });

})();
</script>
</body>
</html>
